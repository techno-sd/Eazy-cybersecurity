generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model activity_logs {
  id          Int       @id @default(autoincrement())
  user_id     Int
  action      String    @db.VarChar(100)
  entity_type String?   @db.VarChar(50)
  entity_id   Int?
  description String?   @db.Text
  ip_address  String?   @db.VarChar(45)
  user_agent  String?   @db.Text
  created_at  DateTime? @default(now()) @db.Timestamp(0)

  @@index([action], map: "idx_action")
  @@index([created_at], map: "idx_created_at")
  @@index([entity_type, entity_id], map: "idx_entity")
  @@index([user_id], map: "idx_user_id")
}

model blog_posts {
  id             Int                @id @default(autoincrement())
  title          String             @db.VarChar(500)
  title_ar       String             @db.VarChar(500)
  slug           String             @unique(map: "slug") @db.VarChar(500)
  excerpt        String?            @db.Text
  excerpt_ar     String?            @db.Text
  content        String             @db.LongText
  content_ar     String             @db.LongText
  featured_image String?            @db.VarChar(500)
  author_id      Int
  status         blog_posts_status? @default(draft)
  views          Int?               @default(0)
  published_at   DateTime?          @db.Timestamp(0)
  created_at     DateTime?          @default(now()) @db.Timestamp(0)
  updated_at     DateTime?          @default(now()) @db.Timestamp(0)

  @@index([author_id], map: "idx_author_id")
  @@index([created_at], map: "idx_created_at")
  @@index([slug], map: "idx_slug")
  @@index([status], map: "idx_status")
}

model consultations {
  id             Int                   @id @default(autoincrement())
  company_name   String                @db.VarChar(255)
  contact_person String                @db.VarChar(255)
  email          String                @db.VarChar(255)
  phone          String                @db.VarChar(50)
  service_type   String?               @db.VarChar(100)
  budget         String?               @db.VarChar(50)
  description    String?               @db.Text
  preferred_date DateTime?             @db.Date
  status         consultations_status? @default(pending)
  ip_address     String?               @db.VarChar(45)
  created_at     DateTime?             @default(now()) @db.Timestamp(0)
  updated_at     DateTime?             @default(now()) @db.Timestamp(0)

  @@index([created_at], map: "idx_created_at")
  @@index([email], map: "idx_email")
  @@index([status], map: "idx_status")
}

model roles {
  id          Int       @id @default(autoincrement())
  name        String    @unique(map: "name") @db.VarChar(50)
  description String?   @db.Text
  menu_access Json?
  is_active   Boolean?  @default(true)
  created_at  DateTime? @default(now()) @db.Timestamp(0)
  updated_at  DateTime? @default(now()) @db.Timestamp(0)

  @@index([is_active], map: "idx_roles_is_active")
  @@index([name], map: "idx_roles_name")
}

model users {
  id                    Int         @id @default(autoincrement())
  email                 String      @unique(map: "email") @db.VarChar(255)
  password_hash         String      @db.VarChar(255)
  full_name             String      @db.VarChar(255)
  phone                 String?     @db.VarChar(50)
  company               String?     @db.VarChar(255)
  role                  users_role? @default(user)
  is_active             Boolean?    @default(true)
  failed_login_attempts Int?        @default(0)
  last_failed_login     DateTime?   @db.Timestamp(0)
  locked_until          DateTime?   @db.Timestamp(0)
  last_login            DateTime?   @db.Timestamp(0)
  last_login_ip         String?     @db.VarChar(45)
  created_at            DateTime?   @default(now()) @db.Timestamp(0)
  updated_at            DateTime?   @default(now()) @db.Timestamp(0)

  @@index([is_active], map: "idx_is_active")
}

enum users_role {
  user
  admin
  moderator
}

enum consultations_status {
  pending
  scheduled
  completed
  cancelled
}

enum blog_posts_status {
  draft
  published
  archived
}
