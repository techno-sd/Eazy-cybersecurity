generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model activity_logs {
  id          Int       @id @default(autoincrement())
  user_id     Int
  action      String    @db.VarChar(100)
  entity_type String?   @db.VarChar(50)
  entity_id   Int?
  description String?   @db.Text
  ip_address  String?   @db.VarChar(45)
  user_agent  String?   @db.Text
  created_at  DateTime? @default(now()) @db.Timestamp(0)

  @@index([action], map: "idx_action")
  @@index([created_at], map: "idx_created_at")
  @@index([entity_type, entity_id], map: "idx_entity")
  @@index([user_id], map: "idx_user_id")
}

model blog_categories {
  id             Int       @id @default(autoincrement())
  name           String    @db.VarChar(100)
  name_ar        String    @db.VarChar(100)
  slug           String    @unique(map: "slug") @db.VarChar(100)
  description    String?   @db.Text
  description_ar String?   @db.Text
  created_at     DateTime? @default(now()) @db.Timestamp(0)

  @@index([slug], map: "idx_slug")
}

model blog_posts {
  id             Int                @id @default(autoincrement())
  title          String             @db.VarChar(500)
  title_ar       String             @db.VarChar(500)
  slug           String             @unique(map: "slug") @db.VarChar(500)
  excerpt        String?            @db.Text
  excerpt_ar     String?            @db.Text
  content        String             @db.LongText
  content_ar     String             @db.LongText
  featured_image String?            @db.VarChar(500)
  author_id      Int
  category       String?            @db.VarChar(100)
  tags           Json?
  status         blog_posts_status? @default(draft)
  views          Int?               @default(0)
  published_at   DateTime?          @db.Timestamp(0)
  created_at     DateTime?          @default(now()) @db.Timestamp(0)
  updated_at     DateTime?          @default(now()) @db.Timestamp(0)

  @@index([author_id], map: "idx_author_id")
  @@index([category], map: "idx_category")
  @@index([published_at], map: "idx_published_at")
  @@index([slug], map: "idx_slug")
  @@index([status], map: "idx_status")
  @@fulltext([title, content, title_ar, content_ar], map: "idx_content")
}

model consultations {
  id           Int                     @id @default(autoincrement())
  name         String                  @db.VarChar(255)
  email        String                  @db.VarChar(255)
  phone        String?                 @db.VarChar(50)
  company      String?                 @db.VarChar(255)
  service_type String?                 @db.VarChar(100)
  message      String                  @db.Text
  status       consultations_status?   @default(new)
  priority     consultations_priority? @default(medium)
  assigned_to  Int?
  notes        String?                 @db.Text
  created_at   DateTime?               @default(now()) @db.Timestamp(0)
  updated_at   DateTime?               @default(now()) @db.Timestamp(0)

  @@index([assigned_to], map: "idx_assigned_to")
  @@index([created_at], map: "idx_created_at")
  @@index([email], map: "idx_email")
  @@index([priority], map: "idx_priority")
  @@index([status], map: "idx_status")
}

model contacts {
  id         Int       @id @default(autoincrement())
  name       String    @db.VarChar(255)
  email      String    @db.VarChar(255)
  phone      String?   @db.VarChar(50)
  subject    String    @db.VarChar(500)
  message    String    @db.Text
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)

  @@index([created_at], map: "idx_created_at")
  @@index([email], map: "idx_email")
}

model sessions {
  id            Int       @id @default(autoincrement())
  user_id       Int
  session_token String    @unique(map: "session_token") @db.VarChar(255)
  ip_address    String?   @db.VarChar(45)
  user_agent    String?   @db.Text
  expires_at    DateTime  @db.Timestamp(0)
  created_at    DateTime? @default(now()) @db.Timestamp(0)

  @@index([expires_at], map: "idx_expires_at")
  @@index([session_token], map: "idx_session_token")
  @@index([user_id], map: "user_id")
}

model users {
  id                    Int         @id @default(autoincrement())
  email                 String      @unique(map: "email") @db.VarChar(255)
  password_hash         String      @db.VarChar(255)
  full_name             String      @db.VarChar(255)
  phone                 String?     @db.VarChar(50)
  company               String?     @db.VarChar(255)
  role                  users_role? @default(user)
  is_active             Boolean?    @default(true)
  failed_login_attempts Int?        @default(0)
  last_failed_login     DateTime?   @db.Timestamp(0)
  locked_until          DateTime?   @db.Timestamp(0)
  last_login            DateTime?   @db.Timestamp(0)
  last_login_ip         String?     @db.VarChar(45)
  created_at            DateTime?   @default(now()) @db.Timestamp(0)
  updated_at            DateTime?   @default(now()) @db.Timestamp(0)

  @@index([email], map: "idx_email")
  @@index([is_active], map: "idx_is_active")
}

model website_settings {
  id            Int                            @id @default(autoincrement())
  setting_key   String                         @unique(map: "setting_key") @db.VarChar(100)
  setting_value String?                        @db.Text
  setting_type  website_settings_setting_type? @default(text)
  description   String?                        @db.VarChar(500)
  updated_by    Int?
  updated_at    DateTime?                      @default(now()) @db.Timestamp(0)

  @@index([setting_key], map: "idx_key")
  @@index([updated_by], map: "updated_by")
}

enum website_settings_setting_type {
  text
  number
  boolean
  json
}

enum users_role {
  admin
  user
  moderator
}

enum consultations_status {
  new
  in_progress
  completed
  cancelled
}

enum consultations_priority {
  low
  medium
  high
  urgent
}

enum blog_posts_status {
  draft
  published
  archived
}
